<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5129097020907805" crossorigin="anonymous"></script>
    
    <meta charset="UTF-8" />
    <title>Tell My Location | Global GPS & Safety Tool</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <meta name="description" content="Instantly find your exact location, address, and local weather. A private, fast safety tool for emergencies. No data storage.">
    <meta name="keywords" content="tell my location, where am i, my gps coordinates, current address, emergency sos, location finder, weather near me">
    
    <meta property="og:title" content="Tell My Location | Global GPS Tool">
    <meta property="og:description" content="Get your exact GPS coordinates, address, and nearest emergency services instantly.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tellmylocation.com">
    <meta property="og:image" content="https://tellmylocation.com/icon.png"> <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0f172a">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Tell My Location",
      "url": "https://tellmylocation.com",
      "applicationCategory": "Utility",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": "GPS Coordinates, Address Lookup, Weather, SOS Sharing, Nearby Services"
    }
    </script>

    <style>
        :root {
            --card: rgba(13, 17, 23, 0.85);
            --accent: #ff0055;
            --neon-blue: #38bdf8;
            --sos-red: #ef4444;
            --text-main: #ffffff;
            --text-soft: #94a3b8;
            --border: rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #111827 100%);
            background-attachment: fixed;
            color: var(--text-main);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .shell { width: 100%; max-width: 800px; display: flex; flex-direction: column; gap: 16px; position: relative; }

        .lang-switch {
            position: absolute;
            top: 0;
            right: 0;
            z-index: 10;
        }
        
        select#language {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid var(--border);
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            outline: none;
        }
        select#language option { background: #0f172a; color: white; }

        body.rtl { direction: rtl; }
        body.rtl .lang-switch { right: auto; left: 0; }
        body.rtl .copy-abs { right: auto; left: 12px; }
        body.rtl #full-address { padding-right: 0; padding-left: 30px; }
        body.rtl .data-item, body.rtl .nearby-item { text-align: right; }

        .brand { text-align: center; margin: 30px 0 15px; } 
        .brand h1 { font-size: 28px; font-weight: 800; letter-spacing: -1px; margin-bottom: 6px; text-shadow: 0 4px 20px rgba(0,0,0,0.5); }
        .brand h1 span { color: var(--accent); }
        .tagline { color: var(--text-soft); font-size: 14px; font-weight: 400; }

        .card {
            background: var(--card);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            border: 1px solid var(--border);
            padding: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .address-box {
            background: rgba(56, 189, 248, 0.05);
            border: 1px solid rgba(56, 189, 248, 0.2);
            padding: 18px;
            border-radius: 16px;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
        }
        .address-box h2 { font-size: 11px; color: var(--neon-blue); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 8px; font-weight: 700; }
        #full-address { font-size: 16px; font-weight: 600; line-height: 1.5; color: #fff; padding-right: 30px; }
        
        .icon-btn {
            background: none; border: none; cursor: pointer; color: var(--neon-blue);
            padding: 5px; display: flex; align-items: center; justify-content: center;
            transition: transform 0.2s;
        }
        .icon-btn:hover { transform: scale(1.1); }
        .copy-abs { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); }

        #map { width: 100%; height: 320px; border-radius: 18px; border: 1px solid var(--border); margin-bottom: 20px; z-index: 1; }

        .data-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-bottom: 24px; }
        .data-item {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            padding: 16px;
            border-radius: 16px;
            text-align: left;
        }
        .label { font-size: 10px; color: var(--text-soft); text-transform: uppercase; margin-bottom: 6px; letter-spacing: 0.5px; }
        .value { font-size: 16px; font-weight: 700; color: #fff; }
        .sub-value { font-size: 11px; color: var(--neon-blue); margin-top: 4px; }

        .nearby-header { font-size: 12px; text-transform: uppercase; color: var(--text-soft); margin-bottom: 10px; letter-spacing: 0.5px; display: flex; align-items: center; gap: 6px; }
        .nearby-list { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        @media(max-width: 600px) { .nearby-list { grid-template-columns: 1fr; } }
        
        .nearby-item {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            padding: 12px;
            border-radius: 12px;
        }
        .nearby-type { font-size: 9px; color: var(--accent); font-weight: 800; text-transform: uppercase; margin-bottom: 4px; }
        .nearby-name { font-size: 13px; font-weight: 600; color: #f1f5f9; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .nearby-dist { font-size: 11px; color: var(--neon-blue); }

        .btn-stack { display: flex; flex-direction: column; gap: 12px; margin-top: 30px; }
        .btn-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

        .btn {
            border: none; border-radius: 14px; padding: 16px; font-weight: 700; 
            cursor: pointer; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 8px;
            transition: transform 0.1s;
        }
        
        .btn-sos { 
            background: var(--sos-red); color: white; width: 100%; font-size: 16px;
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 12px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .btn-primary { background: linear-gradient(135deg, #ff0055, #ff4d7d); color: white; }
        .btn-ghost { background: rgba(255,255,255,0.05); color: white; border: 1px solid var(--border); }
        .btn:active { transform: scale(0.98); }
        .icon { width: 18px; height: 18px; stroke-width: 2.5; }

        .trust-badge { 
            font-size: 12px; color: #94a3b8; text-align: center; margin-top: 25px; line-height: 1.6;
            background: rgba(15, 23, 42, 0.5); padding: 15px; border-radius: 12px; border: 1px dashed var(--border);
        }
        
        footer { margin-top: 40px; text-align: center; font-size: 12px; color: var(--text-soft); padding-bottom: 30px; border-top: 1px solid var(--border); width: 100%; padding-top: 20px;}
        footer a { color: var(--text-soft); text-decoration: none; margin: 0 8px; transition: color 0.2s; }
        footer a:hover { color: white; }

        #cookie-banner {
            display: none; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(30, 41, 59, 0.95); padding: 20px; border-radius: 16px; 
            border: 1px solid var(--neon-blue); 
            box-shadow: 0 10px 40px rgba(0,0,0,0.8); 
            width: 90%; max-width: 400px; z-index: 10000; text-align: center;
            backdrop-filter: blur(10px);
        }
        #cookie-text { margin-bottom: 15px; font-size: 13px; color: #cbd5e1; line-height: 1.5; }
        #cookie-btn {
            background: var(--neon-blue); color: #0f172a; border: none; padding: 10px 24px;
            border-radius: 50px; font-weight: 800; cursor: pointer; font-size: 14px;
        }

        /* PREMIUM UPGRADE CSS INJECT 
           High-end Futuristic Visuals 
        */
        .premium-upgrade-container { animation: fadeIn 1.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .qr-section { text-align: center; margin-bottom: 25px; background: rgba(255,255,255,0.02); padding: 20px; border-radius: 20px; border: 1px solid var(--border); }
        .qr-label { font-size: 12px; text-transform: uppercase; letter-spacing: 2px; color: var(--neon-blue); margin-bottom: 10px; font-weight: 800; }
        #qrcode { display: inline-block; padding: 10px; background: white; border-radius: 12px; box-shadow: 0 0 20px rgba(56, 189, 248, 0.3); }

        .premium-dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin: 20px 0; }
        .p-card { 
            background: linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.01));
            border: 1px solid var(--border); padding: 20px; border-radius: 20px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); cursor: default;
        }
        .p-card:hover { border-color: var(--neon-blue); transform: scale(1.05); box-shadow: 0 10px 30px rgba(56,189,248,0.1); }
        .p-icon { font-size: 20px; margin-bottom: 10px; display: block; opacity: 0.8; }
        .p-label { font-size: 10px; text-transform: uppercase; color: var(--text-soft); }
        .p-value { font-size: 18px; font-weight: 800; color: white; display: block; margin-top: 5px; }

        .compass-wrap { 
            position: relative; width: 220px; height: 220px; margin: 30px auto;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.1) 0%, transparent 70%);
            border-radius: 50%; padding: 10px;
        }
        #compass-svg { width: 100%; height: 100%; transition: transform 0.1s linear; filter: drop-shadow(0 0 10px var(--neon-blue)); }
        .compass-ring { fill: none; stroke: var(--border); stroke-width: 2; }
        .compass-glow { fill: none; stroke: var(--neon-blue); stroke-width: 1; opacity: 0.5; }

        .use-case-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 40px; }
        .use-case-card { 
            background: rgba(255,255,255,0.02); border: 1px solid var(--border); padding: 20px; border-radius: 18px;
            text-align: center; transition: 0.3s;
        }
        .use-case-card:hover { background: rgba(255,255,255,0.05); border-color: var(--accent); }
        .use-case-card h3 { font-size: 13px; text-transform: uppercase; margin-top: 10px; color: var(--text-main); }

        .why-section { 
            padding: 30px; background: linear-gradient(to right, rgba(56,189,248,0.05), transparent);
            border-left: 3px solid var(--neon-blue); border-radius: 12px; margin: 40px 0;
        }
        .why-section h2 { font-size: 18px; color: var(--neon-blue); margin-bottom: 10px; }
        .why-section p { font-size: 14px; color: var(--text-soft); line-height: 1.6; }
    </style>
</head>
<body>

<div class="shell premium-upgrade-container">

    <div class="qr-section">
        <div class="qr-label">Scan to Share Location</div>
        <div id="qrcode"></div>
    </div>

    <div class="lang-switch">
        <select id="language" onchange="changeLanguage(this.value)">
            <option value="en">üá∫üá∏ English</option>
            <option value="es">üá™üá∏ Espa√±ol</option>
            <option value="fr">üá´üá∑ Fran√ßais</option>
            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
            <option value="ar">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
        </select>
    </div>

    <header class="brand">
        <h1>TELLMY<span>LOCATION</span>.COM</h1>
        <p class="tagline" data-i18n="tagline">The fastest "Where am I?" tool on the internet.</p>
    </header>

    <div class="compass-wrap">
        <svg id="compass-svg" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="48" class="compass-ring"/>
            <circle cx="50" cy="50" r="45" class="compass-glow" stroke-dasharray="5,5"/>
            <text x="50" y="12" fill="#38bdf8" font-size="8" text-anchor="middle" font-weight="900">N</text>
            <text x="50" y="93" fill="#94a3b8" font-size="6" text-anchor="middle">S</text>
            <text x="88" y="52" fill="#94a3b8" font-size="6" text-anchor="middle">E</text>
            <text x="12" y="52" fill="#94a3b8" font-size="6" text-anchor="middle">W</text>
            <path d="M50 20 L55 50 L50 80 L45 50 Z" fill="#ff0055" />
            <circle cx="50" cy="50" r="3" fill="white" />
        </svg>
    </div>

    <main class="card">
        <div class="address-box">
            <h2 data-i18n="address_title">üìç Current Address</h2>
            <div id="full-address">...</div>
            <button class="icon-btn copy-abs" id="copy-addr" title="Copy Address">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            </button>
        </div>

        <div id="map"></div>

        <div class="premium-dashboard">
            <div class="p-card">
                <span class="p-icon">üõ∞Ô∏è</span>
                <span class="p-label">Altitude</span>
                <span class="p-value" id="alt-p">‚Äî</span>
            </div>
            <div class="p-card">
                <span class="p-icon">üß≠</span>
                <span class="p-label">Bearing</span>
                <span class="p-value" id="head-p">‚Äî</span>
            </div>
            <div class="p-card">
                <span class="p-icon">üõ°Ô∏è</span>
                <span class="p-label">Security</span>
                <span class="p-value">Encrypted</span>
            </div>
            <div class="p-card">
                <span class="p-icon">üïí</span>
                <span class="p-label">Timestamp</span>
                <span class="p-value" id="time-p">00:00:00</span>
            </div>
        </div>

        <div class="data-grid">
            <div class="data-item">
                <div class="label" data-i18n="gps_label">üåç GPS Coordinates</div>
                <div class="value"><span id="lat-val">‚Äî</span>, <span id="lng-val">‚Äî</span></div>
                <div class="sub-value" id="accuracy-val">...</div>
            </div>
            <div class="data-item">
                <div class="label" data-i18n="weather_label">‚òÅÔ∏è Weather</div>
                <div class="value" id="temp-display">‚Äî</div>
                <div class="sub-value" id="wind-display">Wind: ‚Äî</div>
            </div>
            <div class="data-item">
                <div class="label" data-i18n="ip_label">üåê Network IP</div>
                <div class="value" id="ip-val" style="font-size:14px">‚Äî</div>
                <div class="sub-value" id="isp-val">ISP: ‚Äî</div>
            </div>
        </div>

        <div class="nearby-header">
            <svg style="width:14px;height:14px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
            <span data-i18n="nearby_label">üì° Nearest Emergency Services</span>
        </div>
        <div class="nearby-list" id="nearby-results">
            <div class="nearby-item">...</div>
            <div class="nearby-item">...</div>
            <div class="nearby-item">...</div>
        </div>

        <div class="btn-stack">
            <button class="btn btn-sos" id="sos-btn">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
                <span data-i18n="btn_sos">ONE-TAP SOS SHARE</span>
            </button>
            <div class="btn-row">
                <button class="btn btn-primary" id="refresh-btn">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
                    <span data-i18n="btn_refresh">Refresh</span>
                </button>
                <button class="btn btn-ghost" id="copy-coords-btn">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    <span data-i18n="btn_copy">Copy Lat/Long</span>
                </button>
            </div>
            
            <div class="btn-row">
                <button class="btn" style="background:#10b981; color:white; padding:10px; font-size:12px; box-shadow:0 0 10px rgba(16,185,129,0.4);" onclick="window.open('https://buymeacoffee.com/donshehab')">
                    <svg class="icon" style="width:14px; height:14px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path></svg>
                    <span>Coffee</span>
                </button>
                <button class="btn" style="background:#ffcc00; color:black; font-weight:800; padding:10px; font-size:11px; box-shadow:0 0 15px rgba(255,204,0,0.6);" onclick="window.open('https://waterinmyspeaker.com')">
                    <span>CHECK OTHER TOOL</span>
                </button>
            </div>
        </div>

        <section class="why-section">
            <h2>Why This Interface Matters</h2>
            <p>TellMyLocation utilizes high-frequency satellite pings combined with low-latency network triangulation to deliver hyper-accurate data in milliseconds. We prioritize privacy by ensuring zero data persistence on our backend‚Äîyour location is your business.</p>
        </section>

        <div class="use-case-grid">
            <div class="use-case-card"><span>üöö</span><h3>Delivery Drivers</h3></div>
            <div class="use-case-card"><span>üö®</span><h3>Emergency SOS</h3></div>
            <div class="use-case-card"><span>üèîÔ∏è</span><h3>Hikers/Travelers</h3></div>
            <div class="use-case-card"><span>ü§ù</span><h3>Meeting Friends</h3></div>
        </div>

        <p class="trust-badge">
            <span data-i18n="trust_text">üîí Privacy Guarantee: We do not save, need, or share your location. This website exists solely to help you or save you when needed. All data is processed securely on your device.</span>
        </p>
    </main>

    <footer>
        <div style="margin-bottom: 12px;">
            <a href="privacy.html" data-i18n="link_privacy">Privacy Policy</a> ‚Ä¢ <a href="terms.html" data-i18n="link_terms">Terms of Use</a> ‚Ä¢ <a href="contact.html" data-i18n="link_contact">Contact Us</a>
        </div>
        ¬© 2026 TellMyLocation.com
    </footer>
</div>

<div id="cookie-banner">
    <div id="cookie-text" data-i18n="cookie_text">We use cookies to analyze traffic and show personalized ads to support this free tool.</div>
    <button id="cookie-btn" onclick="acceptCookies()" data-i18n="btn_accept">I Accept</button>
</div>

<script>
    /* ADDED LOGIC FOR NEW VISUALS 
       Note: Existing variables (els, currentPos, map, etc.) remain untouched.
    */

    // Generate QR Code
    new QRCode(document.getElementById("qrcode"), {
        text: window.location.href,
        width: 100,
        height: 100,
        colorDark : "#000000",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.H
    });

    // Real-time Compass Orientation logic
    window.addEventListener('deviceorientation', function(event) {
        if (event.webkitCompassHeading) {
            document.getElementById('compass-svg').style.transform = `rotate(${-event.webkitCompassHeading}deg)`;
            document.getElementById('head-p').textContent = Math.round(event.webkitCompassHeading) + '¬∞';
        } else if (event.alpha) {
            document.getElementById('compass-svg').style.transform = `rotate(${-event.alpha}deg)`;
            document.getElementById('head-p').textContent = Math.round(event.alpha) + '¬∞';
        }
    }, true);

    // Update Premium Dashboard Clock
    setInterval(() => {
        const now = new Date();
        document.getElementById('time-p').textContent = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'});
    }, 1000);

    /* ORIGINAL SCRIPT CONTINUES BELOW 
    */
    const i18n = {
        en: {
            tagline: "The fastest 'Where am I?' tool on the internet.",
            address_title: "Current Address",
            gps_label: "GPS Coordinates",
            weather_label: "Weather",
            ip_label: "Network IP",
            nearby_label: "Nearest Emergency Services",
            btn_sos: "ONE-TAP SOS SHARE",
            btn_refresh: "Refresh",
            btn_copy: "Copy Lat/Long",
            btn_coffee: "Buy Me a Coffee",
            trust_text: "üîí Privacy Guarantee: We do not save, need, or share your location. This website exists solely to help you or save you when needed. All data is processed securely on your device.",
            link_privacy: "Privacy Policy", link_terms: "Terms of Use", link_contact: "Contact Us",
            cookie_text: "We use cookies to analyze traffic and show personalized ads to support this free tool.",
            btn_accept: "I Accept"
        },
        es: {
            tagline: "La herramienta '¬øD√≥nde estoy?' m√°s r√°pida de internet.",
            address_title: "Direcci√≥n Actual",
            gps_label: "Coordenadas GPS",
            weather_label: "Clima",
            ip_label: "IP de Red",
            nearby_label: "Servicios de Emergencia",
            btn_sos: "SOS - COMPARTIR UBICACI√ìN",
            btn_refresh: "Actualizar",
            btn_copy: "Copiar Lat/Long",
            btn_coffee: "Inv√≠tame un Caf√©",
            trust_text: "üîí Garant√≠a de Privacidad: No guardamos, necesitamos ni compartimos tu ubicaci√≥n. Este sitio existe solo para ayudarte o salvarte cuando sea necesario.",
            link_privacy: "Privacidad", link_terms: "T√©rminos", link_contact: "Contacto",
            cookie_text: "Usamos cookies para analizar el tr√°fico y mostrar anuncios personalizados.",
            btn_accept: "Aceptar"
        },
        fr: {
            tagline: "L'outil 'O√π suis-je ?' le plus rapide d'internet.",
            address_title: "Adresse Actuelle",
            gps_label: "Coordonn√©es GPS",
            weather_label: "M√©t√©o",
            ip_label: "IP R√©seau",
            nearby_label: "Services d'Urgence Proches",
            btn_sos: "SOS - PARTAGER MA POSITION",
            btn_refresh: "Actualiser",
            btn_copy: "Copiar Lat/Long",
            btn_coffee: "Offrez-moi un caf√©",
            trust_text: "üîí Garantie de Confidentialit√© : Nous n'enregistrons ni ne partageons votre localisation. Ce site existe uniquement pour vous aider ou vous sauver en cas de besoin.",
            link_privacy: "Confidentialit√©", link_terms: "Conditions", link_contact: "Contact",
            cookie_text: "Nous utilisons des cookies pour analyser le trafic et afficher des publicit√©s.",
            btn_accept: "Accepter"
        },
        ru: {
            tagline: "–°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è.",
            address_title: "–¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å",
            gps_label: "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã GPS",
            weather_label: "–ü–æ–≥–æ–¥–∞",
            ip_label: "IP-–∞–¥—Ä–µ—Å —Å–µ—Ç–∏",
            nearby_label: "–ë–ª–∏–∂–∞–π—à–∏–µ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–ª—É–∂–±—ã",
            btn_sos: "SOS - –û–¢–ü–†–ê–í–ò–¢–¨ –ì–ï–û–ü–û–ó–ò–¶–ò–Æ",
            btn_refresh: "–û–±–Ω–æ–≤–∏—Ç—å",
            btn_copy: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å",
            btn_coffee: "–ö—É–ø–∏—Ç—å –º–Ω–µ –∫–æ—Ñ–µ",
            trust_text: "üîí –ì–∞—Ä–∞–Ω—Ç–∏—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏: –ú—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ–º –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ. –≠—Ç–æ—Ç —Å–∞–π—Ç —Å–æ–∑–¥–∞–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –≤–∞–º –≤ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.",
            link_privacy: "–ü–æ–ª–∏—Ç–∏–∫–∞", link_terms: "–£—Å–ª–æ–≤–∏—è", link_contact: "–ö–æ–Ω—Ç–∞–∫—Ç—ã",
            cookie_text: "–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∞–π–ª—ã cookie –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ø–æ–∫–∞–∑–∞ —Ä–µ–∫–ª–∞–º—ã.",
            btn_accept: "–ü—Ä–∏–Ω—è—Ç—å"
        },
        ar: {
            tagline: "ÿ£ÿ≥ÿ±ÿπ ÿ£ÿØÿßÿ© ŸÑŸÖÿπÿ±ŸÅÿ© ŸÖŸàŸÇÿπŸÉ ÿßŸÑÿ≠ÿßŸÑŸä ÿπŸÑŸâ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™.",
            address_title: "ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑÿ≠ÿßŸÑŸä",
            gps_label: "ÿ•ÿ≠ÿØÿßÿ´Ÿäÿßÿ™ GPS",
            weather_label: "ÿßŸÑÿ∑ŸÇÿ≥",
            ip_label: "ÿπŸÜŸàÿßŸÜ IP",
            nearby_label: "ÿ£ŸÇÿ±ÿ® ÿÆÿØŸÖÿßÿ™ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶",
            btn_sos: "SOS - ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿßŸÑŸÖŸàŸÇÿπ ŸÑŸÑÿ∑Ÿàÿßÿ±ÿ¶",
            btn_refresh: "ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™",
            btn_copy: "ŸÜÿ≥ÿÆ ÿßŸÑÿ•ÿ≠ÿØÿßÿ´Ÿäÿßÿ™",
            btn_coffee: "ÿØÿπŸÖ ÿßŸÑŸÖŸàŸÇÿπ (ŸÇŸáŸàÿ©)",
            trust_text: "üîí ÿ∂ŸÖÿßŸÜ ÿßŸÑÿÆÿµŸàÿµŸäÿ©: ŸÜÿ≠ŸÜ ŸÑÿß ŸÜÿ≠ŸÅÿ∏ ŸÖŸàŸÇÿπŸÉ ÿ£Ÿà ŸÜÿ≠ÿ™ÿßÿ¨ ÿ•ŸÑŸäŸá ÿ£Ÿà ŸÜÿ¥ÿßÿ±ŸÉŸá. Ÿáÿ∞ÿß ÿßŸÑŸÖŸàŸÇÿπ ŸÖŸàÿ¨ŸàÿØ ŸÅŸÇÿ∑ ŸÑŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿ£Ÿà ÿ•ŸÜŸÇÿßÿ∞ŸÉ ÿπŸÜÿØ ÿßŸÑÿ≠ÿßÿ¨ÿ©. ÿ™ÿ™ŸÖ ŸÖÿπÿßŸÑÿ¨ÿ© ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿ£ŸÖÿßŸÜ ÿπŸÑŸâ ÿ¨Ÿáÿßÿ≤ŸÉ.",
            link_privacy: "ÿßŸÑÿÆÿµŸàÿµŸäÿ©", link_terms: "ÿßŸÑÿ¥ÿ±Ÿàÿ∑", link_contact: "ÿßÿ™ÿµŸÑ ÿ®ŸÜÿß",
            cookie_text: "ŸÜÿ≠ŸÜ ŸÜÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸÑŸÅÿßÿ™ ÿ™ÿπÿ±ŸäŸÅ ÿßŸÑÿßÿ±ÿ™ÿ®ÿßÿ∑ ŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿ≠ÿ±ŸÉÿ© ÿßŸÑŸÖÿ±Ÿàÿ± Ÿàÿπÿ±ÿ∂ ÿßŸÑÿ•ÿπŸÑÿßŸÜÿßÿ™.",
            btn_accept: "ŸÇÿ®ŸàŸÑ"
        }
    };

    function changeLanguage(lang) {
        localStorage.setItem('user_lang', lang);
        if (lang === 'ar') { document.body.classList.add('rtl'); } else { document.body.classList.remove('rtl'); }
        const texts = i18n[lang];
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (texts[key]) el.textContent = texts[key];
        });
    }

    const savedLang = localStorage.getItem('user_lang') || 'en';
    document.getElementById('language').value = savedLang;
    changeLanguage(savedLang);

    if (!localStorage.getItem('cookiesAccepted')) {
        document.getElementById('cookie-banner').style.display = 'block';
    }
    function acceptCookies() {
        localStorage.setItem('cookiesAccepted', 'true');
        document.getElementById('cookie-banner').style.display = 'none';
    }

    const els = {
        lat: document.getElementById("lat-val"),
        lng: document.getElementById("lng-val"),
        addr: document.getElementById("full-address"),
        acc: document.getElementById("accuracy-val"),
        temp: document.getElementById("temp-display"),
        wind: document.getElementById("wind-display"),
        ip: document.getElementById("ip-val"),
        isp: document.getElementById("isp-val"),
        nearby: document.getElementById("nearby-results")
    };

    let map, marker, accuracyCircle, currentPos = null;

    function getDistance(lat1, lon1, lat2, lon2) {
        const R = 6371; 
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;
        const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        const km = R * c;
        return { km: km.toFixed(2), mi: (km * 0.621371).toFixed(2) };
    }

    async function updateDashboard(lat, lng, acc) {
        currentPos = { lat, lng };
        try {
            const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json`);
            const data = await res.json();
            els.addr.textContent = data.display_name || "Unknown Address";
        } catch(e) { els.addr.textContent = "..."; }

        try {
            const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lng}&current=temperature_2m,wind_speed_10m`);
            const data = await res.json();
            const c = Math.round(data.current.temperature_2m);
            const f = Math.round((c * 9/5) + 32);
            const kph = Math.round(data.current.wind_speed_10m);
            const mph = Math.round(kph * 0.621371);
            els.temp.textContent = `${f}¬∞F / ${c}¬∞C`;
            els.wind.textContent = `${mph} mph / ${kph} km/h`;
        } catch(e) { els.temp.textContent = "N/A"; }

        try {
            const query = `[out:json][timeout:10];(node["amenity"~"police|hospital|fuel"](around:5000,${lat},${lng}););out body 10;`;
            const res = await fetch("https://overpass-api.de/api/interpreter", { method: "POST", body: query });
            const data = await res.json();
            const types = { police: "Police", hospital: "Hospital", fuel: "Fuel" };
            let best = { police: null, hospital: null, fuel: null };
            data.elements.forEach(el => {
                const t = el.tags.amenity;
                const dist = getDistance(lat, lng, el.lat, el.lon);
                if (!best[t] || parseFloat(dist.km) < parseFloat(best[t].dist.km)) {
                    best[t] = { name: el.tags.name || "Local", dist };
                }
            });
            els.nearby.innerHTML = "";
            Object.keys(best).forEach(k => {
                const item = best[k];
                const div = document.createElement("div");
                div.className = "nearby-item";
                div.innerHTML = item ? 
                    `<div class="nearby-type">${types[k]}</div><div class="nearby-name">${item.name}</div><div class="nearby-dist">${item.dist.mi} mi / ${item.dist.km} km</div>` :
                    `<div class="nearby-type">${types[k]}</div><div class="nearby-name" style="color:#555">None</div>`;
                els.nearby.appendChild(div);
            });
        } catch(e) { console.log("Nearby Error"); }
    }

    function initGPS() {
        if (!navigator.geolocation) { els.addr.textContent = "GPS not supported"; return; }
        navigator.geolocation.getCurrentPosition(pos => {
            const { latitude, longitude, accuracy, altitude } = pos.coords;
            els.lat.textContent = latitude.toFixed(5);
            els.lng.textContent = longitude.toFixed(5);
            els.acc.textContent = `¬±${Math.round(accuracy)}m`;
            
            // Update New Premium Dashboard Fields
            document.getElementById('alt-p').textContent = altitude ? Math.round(altitude) + 'm' : 'Sea Level';

            if (!map) {
                map = L.map("map", { zoomControl: false }).setView([latitude, longitude], 15);
                L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { maxZoom: 19 }).addTo(map);
                marker = L.marker([latitude, longitude]).addTo(map);
                accuracyCircle = L.circle([latitude, longitude], { radius: accuracy }).addTo(map);
            } else {
                map.setView([latitude, longitude], 15);
                marker.setLatLng([latitude, longitude]);
                accuracyCircle.setLatLng([latitude, longitude]);
                accuracyCircle.setRadius(accuracy);
            }
            updateDashboard(latitude, longitude, accuracy);
        }, (err) => { els.addr.textContent = "Please enable Location Services."; }, { enableHighAccuracy: true });
        fetch("https://ipapi.co/json/").then(r=>r.json()).then(d=>{
            els.ip.textContent = d.ip;
            els.isp.textContent = d.org;
        });
    }

    document.getElementById("refresh-btn").addEventListener("click", () => location.reload());
    document.getElementById("copy-coords-btn").addEventListener("click", () => {
        navigator.clipboard.writeText(`${els.lat.textContent}, ${els.lng.textContent}`);
        alert("Coordinates Copied!");
    });
    document.getElementById("copy-addr").addEventListener("click", () => {
        navigator.clipboard.writeText(els.addr.textContent);
        alert("Address Copied!");
    });
    document.getElementById("sos-btn").addEventListener("click", () => {
        if (!currentPos) return alert("Waiting for GPS...");
        const link = `https://maps.google.com/?q=${currentPos.lat},${currentPos.lng}`;
        const msg = `EMERGENCY SOS: My location is ${link}`;
        if (navigator.share) { navigator.share({ title: 'SOS', text: msg, url: link }); } else { window.location.href = `sms:?body=${encodeURIComponent(msg)}`; }
    });
    initGPS();
</script>
</body>
</html>
